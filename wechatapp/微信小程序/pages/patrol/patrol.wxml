<!--pages/patrol/patrol.wxml-->
<view class="container">
  <!-- 标题栏 -->
  <view class="header">
    <text class="title">巡查地点监控</text>
  </view>
  
   <!-- 加载状态 -->
   <view class="loading" wx:if="{{isLoading}}">加载中...</view>
  <!-- 实时监控信息 -->
  <view class="card" wx:else></view>
  <view class="card">
    <view class="section">
      <text class="section-title">当前位置</text>
      <text class="section-content">{{location}}</text>
    </view>
    
    <view class="section">
      <text class="section-title">更新时间</text>
      <text class="section-content">{{updateTime}}</text>
    </view>
    
    <view class="section">
      <text class="section-title">安全状态</text>
      <view class="status">
        <image src="{{statusIcon}}" class="status-icon"></image>
        <text class="status-text {{statusClass}}">{{statusText}}</text>
      </view>
    </view>
    
    <view class="section" wx:if="{{drowning}}">
      <text class="section-title warning">紧急情况</text>
      <text class="section-content warning">检测到人员落水！请立即救援！</text>
    </view>
  </view>
  
  <!-- 地图显示 -->
  <map 
    id="patrolMap"
    show-location 
    location-type="gcj02"
    longitude="{{longitude}}"
    latitude="{{latitude}}"
    scale="16"
    markers="{{markers}}"
    style="width: 100%; height: 400rpx; margin-top: 40rpx;"
  ></map>
  
  <!-- 操作按钮 -->
  <button class="action-btn" bindtap="refreshData" disabled="{{isLoading}}">
    {{isLoading ? '加载中...' : '刷新数据'}}
  </button>
</view>